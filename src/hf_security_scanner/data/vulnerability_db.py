"""Vulnerability database and CVE patterns."""

# Known vulnerable package versions
VULNERABLE_PACKAGES = {
    "transformers": {
        "4.0.0": {
            "cve": "CVE-2023-XXXXX",
            "severity": "high",
            "description": "Arbitrary code execution via model loading",
            "fixed_in": "4.0.1"
        },
    },
    "torch": {
        "1.13.0": {
            "cve": "CVE-2022-45907",
            "severity": "high",
            "description": "Arbitrary code execution in torch.load()",
            "fixed_in": "1.13.1"
        },
    },
    "tensorflow": {
        "2.11.0": {
            "cve": "CVE-2022-XXXXX",
            "severity": "medium",
            "description": "Security vulnerability in TensorFlow",
            "fixed_in": "2.11.1"
        },
    },
    "numpy": {
        "1.21.0": {
            "cve": "CVE-2021-XXXXX",
            "severity": "low",
            "description": "Buffer overflow in numpy",
            "fixed_in": "1.21.1"
        },
    },
}

# Dependency security patterns
DEPENDENCY_PATTERNS = {
    "outdated_major_version": {
        "severity": "medium",
        "description": "Major version is outdated",
    },
    "no_version_specified": {
        "severity": "low",
        "description": "No version constraint specified",
    },
    "unpinned_dependency": {
        "severity": "low",
        "description": "Dependency version not pinned",
    },
}

# Unsafe model loading patterns
UNSAFE_LOADING_PATTERNS = [
    "torch.load",  # Can execute arbitrary code
    "pickle.load",  # Unsafe deserialization
    "joblib.load",  # Can execute code
    "np.load.*allow_pickle.*True",  # Unsafe numpy load
]
